<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Persona Fest 2025</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="modern-bg"></div>
    <nav class="navbar"> 
        <div class="navbar__container">
            <a href="index.html" id="navbar__logo">
                <img src="images/MIT_ADT_Logo.png" alt="MIT-ADT Logo" style="height:2.1rem;vertical-align:middle;margin-right:0.7rem;display:inline-block;">
                MIT Art, Design, & Technology University
            </a>
            <ul class="navbar__menu">
                <li class="navbar__item"><a href="index.html" class="navbar__links">Home</a></li>
                <li class="navbar__item navbar__dropdown">
                    <a href="tech.html" class="navbar__links" id="eventsDropdownLink">Events &#9662;</a>
                    <ul class="dropdown-menu">
                        <li><a href="tech.html#hackathon" class="navbar__links">Hackathon</a></li>
                        <li><a href="tech.html#design" class="navbar__links">Design Contest</a></li>
                        <!-- Add more events as needed -->
                    </ul>
                </li>
                <li class="navbar__item"><a href="#games" class="navbar__links">Games</a></li>
                <li class="navbar__btn"><a href="#signup" class="button" id="signupNavBtn">REGISTER</a></li>
                <li class="navbar__btn"><button id="logoutBtn" class="button" style="display:none;">Logout</button></li>
            </ul>
        </div>
    </nav>
    <!-- Login Modal -->    
    <div id="loginModal" style="display:flex;">
        <form id="loginForm">
            <h2><span class="modal-icon">üîê</span>Login</h2>
            <input type="email" id="loginEmail" placeholder="Email" required>
            <input type="password" id="loginPassword" placeholder="Password" required>
            <button type="submit" class="button">Login</button>
            <div id="loginMsg"></div>
            <div class="modal-switch">New user?
                <a href="#" id="showRegister">Register here</a>
            </div>
        </form>
    </div>
    <!-- Register Modal -->
    <div id="registerModal" style="display:none;">
        <form id="registerForm">
            <h2><span class="modal-icon">üìù</span>Register</h2>
            <input type="email" id="registerEmail" placeholder="Email" required>
            <input type="password" id="registerPassword" placeholder="Password" required>
            <button type="submit" class="button">Register</button>
            <div id="registerMsg"></div>
            <div class="modal-switch">Already have an account?
                <a href="#" id="showLogin">Login here</a>
            </div>
        </form>
    </div>
    <header class="hero">
        <h1>Welcome to MIT-ADT University's Persona Fest 2025</h1>
        <p>Participate in exciting events and games. Register now!</p>
        <a href="#signup" class="button hero-btn">Register Now</a>
    </header>
    <section class="events">
        <h2>Featured Events</h2>
        <div class="event-list">
            <div class="event-card">
                <h3>Hackathon</h3>
                <p>Showcase your coding skills and win prizes!</p>
            </div>
            <div class="event-card">
                <h3>Design Contest</h3>
                <p>Unleash your creativity in our design challenge.</p>
            </div>
        </div>
<section id="about" class="about">
    <h2><u>About Persona Fest 2025:</u></h2>
    <p>
        MIT-ADT University's <strong>Persona Fest 2025</strong> was a spectacular three-day techno-cultural extravaganza 
        that transformed the campus into a vibrant hub of creativity, innovation, and celebration. Held from 
        <strong>March 11 to 13</strong>, the fest welcomed over <strong>17,000 students</strong> from more than 
        <strong>125 colleges and universities</strong>.
    </p>
    <p>
        The atmosphere was electric‚Äîfilled with <strong>live music performances</strong>, 
        <strong>sky-lighting fireworks</strong>, and <strong>ground-shaking beats</strong> 
        that kept the energy soaring throughout the event.
    </p>
    <ul>
        <li><strong>Cultural Events</strong>: Dance battles, drama performances, fashion shows, and musical showcases.</li>
        <li><strong>Technical Events</strong>: Hackathons, coding competitions, and robotics exhibitions.</li>
        <li><strong>Food-Tech & Management</strong>: Culinary challenges, startup pitch contests, and business strategy games.</li>
        <li><strong>Design Events</strong>: Art installations, graphic design competitions, and creative workshops.</li>
        <li><strong>MANET Events</strong>: Military-inspired activities and simulations.</li>
    </ul>
    <p>
        Workshops led by <strong>eminent speakers</strong> and industry professionals provided learning opportunities, 
        while exhibitions showcased student innovations and artistic talents. 
        The entire campus buzzed with excitement, camaraderie, and a spirit of collaboration, 
        making Persona Fest not just an event but a <strong>memorable experience</strong> for everyone involved.
    </p>
</section>
    <section id="signup" class="signup" style="display:none;">
        <h2>Register for Events</h2>
        <form id="signupForm">
            <input type="text" name="name" placeholder="Your Name" required>
            <input type="email" name="email" id="signupEmail" placeholder="Your Email" required readonly>
            <select name="event" id="eventSelect" required>
                <option value="">Select Event</option>
                <optgroup label="Technical Events">
                    <option value="Hackathon">Hackathon</option>
                    <option value="Design Contest">Design Contest</option>
                </optgroup>
                <optgroup label="Physical Sports (Team)">
                    <option value="Cricket">Cricket</option>
                    <option value="Football">Football</option>
                    <option value="Hockey">Hockey</option>
                </optgroup>
                <optgroup label="ESports - Mobile">
                    <option value="BGMI">BGMI</option>
                    <option value="Free Fire">Free Fire</option>
                    <option value="CODM">CODM</option>
                </optgroup>
                <optgroup label="ESports - PC">
                    <option value="Valorant">Valorant</option>
                    <option value="COD Warzone">COD Warzone</option>
                    <option value="CS2">CS2</option>
                </optgroup>
            </select>
            <div id="teamFields" style="display:none;">
                <input type="text" name="teamName" placeholder="Team Name">
                <input type="number" name="teamMembers" placeholder="Number of Team Members" min="2" max="11">
            </div>
            <div id="squadFields" style="display:none; margin-top:1rem;">
                <div id="squadPlayers"></div>
            </div>
            <button type="submit" class="button">REGISTER</button>
        </form>
        <div id="signupMessage"></div>
    </section>
    <!-- Profile Section -->
    <section id="profile" class="profile" style="display:none;">
        <h2>Your Profile</h2>
        <form id="profileForm">
            <input type="text" name="profileName" placeholder="Full Name" required>
            <input type="tel" name="profilePhone" placeholder="Phone Number" pattern="[0-9]{10}" required>
            <input type="date" name="profileDOB" placeholder="Date of Birth" required>
            <input type="text" name="profileClass" placeholder="Class (e.g. B.Tech CSE-A)" required>
            <input type="text" name="profileEnrollment" placeholder="Enrollment Number" required>
            <select name="profileYear" required>
                <option value="">Select Year</option>
                <option value="First Year">First Year</option>
                <option value="Second Year">Second Year</option>
                <option value="Third Year">Third Year</option>
                <option value="Final Year">Final Year</option>
                <option value="Masters">Masters</option>
            </select>
            <button type="submit" class="button">Save Profile</button>
        </form>
        <div id="profileMsg"></div>
    </section>
    <section id="dev-console" class="dev-console" style="display:none;">
        <h2>Dev Console: Event Sign-Ups</h2>
        <button id="clearSignups" class="button" style="margin-bottom:1rem;">Clear All Registrations</button>
        <div style="overflow-x:auto;">
            <table id="signupsTable" border="1" cellpadding="6" style="width:100%;background:#fff;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Event</th>
                        <th>Team Name</th>
                        <th>Team Members</th>
                        <th>Squad</th>
                        <th>Substitute</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Sign-up rows will be inserted here -->
                </tbody>
            </table>
        </div>
    </section>
    <footer>
        <p>&copy; 2025 MIT Art, Design & Technology University Events. All rights reserved.</p>
    </footer>
    <button id="toggleDevConsole" class="button" style="position:fixed;bottom:20px;right:20px;z-index:1000;display:none;">Dev Console</button>
    <script src="app.js"></script>
    <script>
// --- LOGIN SYSTEM ---
const SUPER_ADMIN_EMAIL = "vserva2006@gmail.com"; // Your email

function getUsers() {
    return JSON.parse(localStorage.getItem('users') || '[]');
}
function saveUser(email, password, isAdmin = false) {
    let users = getUsers();
    if (users.find(u => u.email === email)) return false;
    users.push({ email, password, isAdmin });
    localStorage.setItem('users', JSON.stringify(users));
    return true;
}
function checkUser(email, password) {
    let users = getUsers();
    return users.find(u => u.email === email && u.password === password);
}
function setLoggedIn(email) {
    localStorage.setItem('loggedInUser', email);
}
function getLoggedIn() {
    return localStorage.getItem('loggedInUser');
}
function logout() {
    localStorage.removeItem('loggedInUser');
    location.reload();
}
function isAdmin(email) {
    if (!email) return false;
    if (email === SUPER_ADMIN_EMAIL) return true;
    let users = getUsers();
    let user = users.find(u => u.email === email);
    return user && user.isAdmin;
}

// Modal logic
const loginModal = document.getElementById('loginModal');
const registerModal = document.getElementById('registerModal');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const loginMsg = document.getElementById('loginMsg');
const registerMsg = document.getElementById('registerMsg');
const showRegister = document.getElementById('showRegister');
const showLogin = document.getElementById('showLogin');
const signupSection = document.getElementById('signup');
const profileSection = document.getElementById('profile');
const profileForm = document.getElementById('profileForm');
const profileMsg = document.getElementById('profileMsg');
const devConsoleSection = document.getElementById('dev-console');
const toggleDevBtn = document.getElementById('toggleDevConsole');
const logoutBtn = document.getElementById('logoutBtn');
const signupNavBtn = document.getElementById('signupNavBtn');

// User Management UI
let userMgmtSection;
function renderUserManagement() {
    if (!userMgmtSection) {
        userMgmtSection = document.createElement('div');
        userMgmtSection.id = "userMgmtSection";
        userMgmtSection.innerHTML = `
            <h3>User Management</h3>
            <table id="userMgmtTable" border="1" cellpadding="6" style="width:100%;background:#fff;margin-bottom:1rem;">
                <thead>
                    <tr>
                        <th>Email</th>
                        <th>Admin</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        `;
        devConsoleSection.insertBefore(userMgmtSection, devConsoleSection.children[1]);
    }
    const tableBody = userMgmtSection.querySelector('tbody');
    tableBody.innerHTML = '';
    const users = getUsers();
    const loggedIn = getLoggedIn();
    users.forEach(u => {
        let isSuper = u.email === SUPER_ADMIN_EMAIL;
        let adminStatus = u.isAdmin || isSuper ? "Yes" : "No";
        let actionBtns = '';
        if (loggedIn === SUPER_ADMIN_EMAIL && !isSuper) {
            actionBtns = `
                <select data-email="${u.email}" class="admin-select" style="padding:4px;">
                    <option value="user" ${!u.isAdmin ? 'selected' : ''}>User</option>
                    <option value="admin" ${u.isAdmin ? 'selected' : ''}>Admin</option>
                </select>
            `;
        } else if (isSuper) {
            actionBtns = `<span style="color:green;font-weight:bold;">Super Admin</span>`;
        }
        tableBody.innerHTML += `
            <tr>
                <td>${u.email}${isSuper ? " <b>(You)</b>" : ""}</td>
                <td>${adminStatus}</td>
                <td>${actionBtns}</td>
            </tr>
        `;
    });
    // Add event listeners for dropdowns
    tableBody.querySelectorAll('.admin-select').forEach(select => {
        select.onchange = function() {
            const email = this.getAttribute('data-email');
            const value = this.value;
            let users = getUsers();
            let idx = users.findIndex(u => u.email === email);
            if (idx !== -1) {
                users[idx].isAdmin = (value === "admin");
                localStorage.setItem('users', JSON.stringify(users));
                renderUserManagement();
            }
        };
    });
}

function showLoginModal() {
    loginModal.style.display = "flex";
    registerModal.style.display = "none";
}
function showRegisterModal() {
    loginModal.style.display = "none";
    registerModal.style.display = "flex";
}
showRegister.onclick = function(e) { e.preventDefault(); showRegisterModal(); }
showLogin.onclick = function(e) { e.preventDefault(); showLoginModal(); }

loginForm.onsubmit = function(e) {
    e.preventDefault();
    const email = loginForm.loginEmail.value.trim();
    const password = loginForm.loginPassword.value;
    if (checkUser(email, password)) {
        setLoggedIn(email);
        loginModal.style.display = "none";
        afterLogin();
    } else {
        loginMsg.textContent = "Invalid email or password.";
    }
};
registerForm.onsubmit = function(e) {
    e.preventDefault();
    const email = registerForm.registerEmail.value.trim();
    const password = registerForm.registerPassword.value;
    if (!email || !password) {
        registerMsg.textContent = "Please fill all fields.";
        return;
    }
    if (saveUser(email, password, false)) {
        registerMsg.style.color = "green";
        registerMsg.textContent = "Registration successful! Please login.";
        setTimeout(showLoginModal, 1000);
    } else {
        registerMsg.style.color = "red";
        registerMsg.textContent = "User already exists.";
    }
};

    // Profile section logic
    function getProfileKey(email) {
        return `profile_${email}`;
    }
    function loadProfile() {
        const user = getLoggedIn();
        if (!user) return;
        const data = JSON.parse(localStorage.getItem(getProfileKey(user)) || '{}');
        profileForm.profileName.value = data.name || '';
        profileForm.profilePhone.value = data.phone || '';
        profileForm.profileDOB.value = data.dob || '';
        profileForm.profileClass.value = data.class || '';
        profileForm.profileEnrollment.value = data.enrollment || '';
        profileForm.profileYear.value = data.year || '';
    }
    function saveProfile() {
        const user = getLoggedIn();
        if (!user) return;
        const data = {
            name: profileForm.profileName.value.trim(),
            phone: profileForm.profilePhone.value.trim(),
            dob: profileForm.profileDOB.value,
            class: profileForm.profileClass.value.trim(),
            enrollment: profileForm.profileEnrollment.value.trim(),
            year: profileForm.profileYear.value
        };
        localStorage.setItem(getProfileKey(user), JSON.stringify(data));
    }

    if (profileForm) {
        profileForm.onsubmit = function(e) {
            e.preventDefault();
            saveProfile();
            profileMsg.textContent = "Profile updated!";
            profileMsg.style.color = "green";
        };
    }

    // Show profile section after sign-up section when logged in
    function afterLogin() {
        const user = getLoggedIn();
        if (user) {
            signupSection.style.display = "block";
            profileSection.style.display = "block";
            loadProfile();
            logoutBtn.style.display = "inline-block";
            signupNavBtn.style.display = "inline-block";
            // Fill email in signup form
            const signupEmail = document.getElementById('signupEmail');
            if (signupEmail) signupEmail.value = user;
            if (isAdmin(user)) {
                toggleDevBtn.style.display = "inline-block";
            } else {
                toggleDevBtn.style.display = "none";
                devConsoleSection.style.display = "none";
            }
        }
    }
    logoutBtn.onclick = logout;

    // Hide sign-up, profile, and dev console by default
    signupSection.style.display = "none";
    profileSection.style.display = "none";
    devConsoleSection.style.display = "none";
    toggleDevBtn.style.display = "none";
    logoutBtn.style.display = "none";
    signupNavBtn.style.display = "none";

    // On page load, check login
    window.onload = function() {
        const user = getLoggedIn();
        if (user) {
            loginModal.style.display = "none";
            registerModal.style.display = "none";
            afterLogin();
        } else {
            loginModal.style.display = "flex";
        }
    };

    // Dev Console toggle (admin only)
    toggleDevBtn.onclick = function() {
        if (devConsoleSection.style.display === "none") {
            devConsoleSection.style.display = "block";
            loadSignups(); // Always refresh!
            if (getLoggedIn() === SUPER_ADMIN_EMAIL) {
                if (userMgmtSection && userMgmtSection.parentNode) {
                    userMgmtSection.parentNode.removeChild(userMgmtSection);
                    userMgmtSection = null;
                }
                renderUserManagement();
            }
        } else {
            devConsoleSection.style.display = "none";
        }
    };

    // Move loadSignups to global scope so it can be called from toggleDevBtn
    function loadSignups() {
        const signupsTable = document.getElementById('signupsTable').querySelector('tbody');
        signupsTable.innerHTML = '';
        const signups = JSON.parse(localStorage.getItem('eventSignups') || '[]');
        if (signups.length === 0) {
            signupsTable.innerHTML = '<tr><td colspan="7" style="text-align:center;">No sign-ups yet.</td></tr>';
        } else {
            signups.forEach(s => {
                let squadList = Array.isArray(s.squad) && s.squad.length
                    ? s.squad.map((p, i) => p ? `P${i+1}: ${p}` : '').filter(Boolean).join('<br>')
                    : '-';
                let squadSub = s.squadSub ? s.squadSub : '-';
                signupsTable.innerHTML += `<tr>
                    <td>${s.name}</td>
                    <td>${s.email}</td>
                    <td>${s.event}</td>
                    <td>${s.teamName || '-'}</td>
                    <td>${s.teamMembers || '-'}</td>
                    <td>${squadList}</td>
                    <td>${squadSub}</td>
                </tr>`;
            });
        }
    }

    // Show team fields for team events
    document.addEventListener('DOMContentLoaded', function () {
        const eventSelect = document.getElementById('eventSelect');
        const teamFields = document.getElementById('teamFields');
        const squadFields = document.getElementById('squadFields');
        const squadPlayers = document.getElementById('squadPlayers');

        eventSelect.addEventListener('change', function () {
            const teamEvents = ['Cricket', 'Football', 'Hockey'];
            const squad4Events = ['BGMI', 'Free Fire', 'CODM', 'COD Warzone'];
            const squad5Events = ['Valorant', 'CS2'];

            // Team fields
            if (teamEvents.includes(eventSelect.value)) {
                teamFields.style.display = 'block';
                teamFields.querySelector('input[name="teamName"]').required = true;
                teamFields.querySelector('input[name="teamMembers"]').required = true;
            } else {
                teamFields.style.display = 'none';
                teamFields.querySelector('input[name="teamName"]').required = false;
                teamFields.querySelector('input[name="teamMembers"]').required = false;
            }

            // Squad fields
            squadFields.style.display = 'none';
            squadPlayers.innerHTML = '';
            if (squad4Events.includes(eventSelect.value)) {
                squadFields.style.display = 'block';
                let html = '';
                for (let i = 1; i <= 4; i++) {
                    html += `<input type="text" name="squadPlayer${i}" placeholder="Player ${i} Name" required style="margin-bottom:4px;">`;
                }
                html += `<input type="text" name="squadSub" placeholder="Substitute Name (optional)" style="margin-bottom:4px;">`;
                squadPlayers.innerHTML = html;
            } else if (squad5Events.includes(eventSelect.value)) {
                squadFields.style.display = 'block';
                let html = '';
                for (let i = 1; i <= 5; i++) {
                    html += `<input type="text" name="squadPlayer${i}" placeholder="Player ${i} Name" required style="margin-bottom:4px;">`;
                }
                html += `<input type="text" name="squadSub" placeholder="Substitute Name (optional)" style="margin-bottom:4px;">`;
                squadPlayers.innerHTML = html;
            }
        });

        // Dev Console logic
        const devConsole = document.getElementById('dev-console');
        const toggleBtn = document.getElementById('toggleDevConsole');
        const signupsTable = document.getElementById('signupsTable').querySelector('tbody');
        const clearBtn = document.getElementById('clearSignups');

        clearBtn.addEventListener('click', function () {
            if (confirm('Clear all sign-ups?')) {
                localStorage.removeItem('eventSignups');
                loadSignups();
            }
        });

        // Save sign-ups from the form
        const signupForm = document.getElementById('signupForm');
        if (signupForm) {
            signupForm.addEventListener('submit', function (e) {
                e.preventDefault();
                const name = signupForm.name.value.trim();
                const email = getLoggedIn();
                if (signupForm.email) signupForm.email.value = email;
                const event = signupForm.event.value;
                const teamName = signupForm.teamName ? signupForm.teamName.value.trim() : '';
                const teamMembers = signupForm.teamMembers ? signupForm.teamMembers.value.trim() : '';
                let squad = [];
                let squadSub = '';
                if (squadFields.style.display === 'block') {
                    for (let i = 1; ; i++) {
                        const playerInput = signupForm.querySelector(`[name="squadPlayer${i}"]`);
                        if (!playerInput) break;
                        squad.push(playerInput.value.trim());
                    }
                    const subInput = signupForm.querySelector('[name="squadSub"]');
                    if (subInput) squadSub = subInput.value.trim();
                }
                if (name && email && event) {
                    let signups = JSON.parse(localStorage.getItem('eventSignups') || '[]');
                    signups.push({ name, email, event, teamName, teamMembers, squad, squadSub });
                    localStorage.setItem('eventSignups', JSON.stringify(signups));
                    loadSignups();
                    signupForm.reset();
                    squadFields.style.display = 'none';
                    teamFields.style.display = 'none';
                    document.getElementById('signupMessage').textContent = "Registration successful!";
                    // Re-set email after reset
                    if (signupForm.email) signupForm.email.value = email;
                }
            });
        }

        const signupEmail = document.getElementById('signupEmail');
        if (signupEmail) {
            signupEmail.value = getLoggedIn();
        }
    });
    </script>
    <!-- Make Events tab clickable and dropdown on hover -->
    <script>
// Make Events tab clickable and dropdown on hover
document.addEventListener('DOMContentLoaded', function () {
    var eventsDropdownLink = document.getElementById('eventsDropdownLink');
    if (eventsDropdownLink) {
        eventsDropdownLink.addEventListener('click', function(e) {
            window.location.href = 'tech.html';
        });
    }
});
    </script>
    <style>
.navbar__dropdown .dropdown-menu {
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: opacity 0.25s ease, transform 0.25s ease, visibility 0.25s;
    pointer-events: none;
}

.navbar__dropdown.open .dropdown-menu,
.navbar__dropdown:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
    pointer-events: auto;
}
    </style>
</body>
</html>